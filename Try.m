clear; clc

ga=0.5;
c1=0.5;
h=0.03;
I=eye(7);
Be=7.5E-3;
Bei=[2.850000E-04 1.597500E-03 1.410000E-03 3.052500E-03 9.600000E-04 1.950000E-04];
t1=[0];
rho1=0.0075*t1;
drho1=0.0075;
t2=[0.5:0.01,0.99];
rho2=-0.0075*(t2-0.5)+0.0075*0.5;
drho2=-0.0075;
t3=[1:0.01,1.49];
rho3=0.0075*(t3-1.0);
drho3=0.0075;
t4=[1.5:0.01,10];
rho4=0.00375;
drho4=0.00;
L=[0.0127 0.0317 0.115 0.311 1.40 3.87];
A=5E-4;
n0=1;
PBa=(rho1-Be)/A; %rho*beta/A
Ba1=(Bei(1)/A);%beta_i/A
Ba2=(Bei(2)/A);
Ba3=(Bei(3)/A);
Ba4=(Bei(4)/A);
Ba5=(Bei(5)/A);
Ba6=(Bei(6)/A);
npa=(n0*drho1)/A;%(n(t)/A)*(drho/dt)

% 1/gamma*h
F1=1/(ga*h);

%df/dy
dfdy=[PBa L(1) L(2) L(3) L(4) L(5) L(6);Ba1 -L(1) -L(2) -L(3) -L(4) -L(5) -L(6);Ba2 -L(1) -L(2) -L(3) -L(4) -L(5) -L(6);Ba3 -L(1) -L(2) -L(3) -L(4) -L(5) -L(6);Ba4 -L(1) -L(2) -L(3) -L(4) -L(5) -L(6);Ba5 -L(1) -L(2) -L(3) -L(4) -L(5) -L(6);Ba6 -L(1) -L(2) -L(3) -L(4) -L(5) -L(6)];

%df/dt
dfdt=[npa;0;0;0;0;0;0];

%Approach1
%y=[n0;4.488189E+01;1.007886E+02;2.452174E+01;1.963023E+01;1.371429E+00;1.007752E-01];
%f=dfdy*y;
%g1=f+(h.*c1.*dfdt)./(F1.*I-dfdy)

%Approach2
%g1=[0.0028;-14.43;-11.805;-12.18;-8.895;-13.08;-14.61];
%y=(((F1.*I-dfdy).*g1)-(h.*c1.*dfdt))./dfdy